# 7장 무선 및 이동 네트워크

## 7.3 와이파이 : 802.11 무선 랜

### 7.3.1 802.11 WLAN 구조

### 7.3.2 802.11 MAC 프로토콜

### 7.3.3 IEEE 802.11 프레임

### 7.3.4 동일한 IP 서브넷 내에서의 이동성

---

## **7.4 셀룰러 네트워크: 4G, 5G**

### **`셀룰러(cellular) 네트워크`**

- 셀룰러라는 용어는 셀룰러 네트워크의 영역이 전파 도달 능력에 따라 여러 개의 지리적 영역, 즉 셀(cell)로 나뉜다는 사실에서 비롯됨
- 각각의 셀은 셀 영역 안의 이동 장치와 신호를 주고받는 기지국을 가짐
- 하나의 셀이 담당하는 영역의 넓이는 여러 요소에 의해 영향을 받음
  - 기지국과 단말기의 송신 강도
  - 셀 내의 방해가 되는 건물
  - 기지국 안테나의 설치 높이와 종류

### **7.4.1 4G LTE**(Long-Term Evolution) **셀룰러 네트워크: 구조 및 요소**

### `4G LTE 네트워크 구조의 주요 요소`

![image](../image/7.1.png)

![image](../image/7.2.png)

**`이동 장치(UE)`**

- 셀룰러 통신 사업자의 네트워크에 연결되는 스마트폰, 태블릿, 노트북, IoT 장치 등
- 웹 브라우저, 지도 앱, 음성 및 화상회의 앱, 모바일 결제 앱 등이 실행되는 곳
- NAT을 통해 얻을 수 있는 IP 주소를 갖고 있는 **네트워크의 종단점**
- 전 세계적으로 고유한 IMSI(International Mobile Subscriber Identity)라는 64비트의 식별자 존재
  - 가입자가 속한 국가 및 홈 네트워크를 포함하여 전 세계의 셀룰러 사업자 시스템에서 가입지를 식별한다. (like MAC 주소)
  - SIM(Subscriber Identity Module) 카드에 저장됨
  - SIM 카드는 가입자가 접속할 수 있는 서비스에 대한 정보와 해당 가입자의 키 정보를 암호화

**`기지국(base station)`**

- 셀룰러 통신 사업자 네트워크의 가장자리에 위치
- 무선 전파 자원 및 담당 영역에 속한 이동 장치를 관리
- 이동 장치는 기지국과 상호작용함으로써 사업자의 네트워크에 접속
- 무선 접속 네트워크에서 장치의 인증 및 자원(무선 채널)의 할당 기능 조정
- 무선랜의 AP와 다르게, 셀룰러 기지국에서만 수행하는 역할
  - AP 이동 장치에서 게이트웨이까지 장치 `고유의 IP 터널`을 생성하고, 셀 간의 장치 이동성을 처리하기 위해 상호작용
  - 인접한 기지국들은 셀 사이의 간섭을 최소화하기 위해 무선 스펙트럼을 관리하기 위한 상호 조정 기능을 수행

**`홈 가입자 서버(Home Subscriber Server, HSS)`**

- HSS의 네트워크를 홈 네트워크로 사용하는 이동 장치에 대한 정보를 저장하는 데이터베이스
- 제어 평면의 요소
- 이동 장치의 인증을 위해 **이동성 관리 개체(MME)**와 함께 사용된다.

**`S-GW(Serving Gateway), P-GW(Packet data Network Gateway)`**

- 이동 장치와 인터넷 사이에 위치하는 2개의 라우터

**`PDN 게이트웨이(P-GW)`**

- 이동 장치에 **NAT IP 주소**를 제공하고 NAT 기능 수행

**`이동성 관리 개체(Mobility Management Entity, MME)`**

- 제어 평면의 요소
- HSS와 함께 네트워크에 접속하려는 장치를 **인증**하는데 사용됨
- 이동 장치와 PDN 인터넷 게이트웨이 간의 데이터 경로에 터널 설정
- 사업자의 셀룰러 네트워크 안에서 활성화된 이동 장치의 셀 위치 정보를 유지 관리
- **`but`** 이동 장치의 데이터그램이 인터넷으로 전송되거나 들어오는 전달 경로상에 있지 X

**인증(authentication)**

- 네트워크와 네트워크에 부착된 이동 장치 간의 **상호** 인증
  - 네트워크는 부착된 장치가 실제로 주어진 IMSI와 연관된 장치라는 것을 알아야 함
  - 이동 장치는 자신이 부착하고 있는 네트워크가 또한 합법적인 셀룰러 사업자 네트워크임을 알아야 함
- **MME**가 이동 홈 네트워크에서 이동 장치와 홈 가입자 서버 **HSS** 사이의 중재자 역할
  1. 로컬 MME는 이동 장치로부터 접속 요청을 수신 → 이동 장치의 홈 네트워크 HSS에 접촉
  2. 이동 장치의 홈 HSS → 로컬 MME에 암호화된 정보 반환

**경로 설정(path setup)**

- 이동 장치로부터 게이트웨이 라우터로의 데이터 경로
  - 이동 장치와 기지국 사이의 무선 첫 번째 홉, 기지국과 서빙 게이트웨이(S-GW) 사이의 연결된 **`IP 터널, 서빙 게이트웨이, PDN 게이트웨이`**로 구성
- 터널은 MME의 제어하에 설정
- **장치가 다른 기지국으로 이동했을 때 → 기지국에서 종료하는 터널 종단점만 변경되며,** 다른 터널 종단점 및 터널과 관련된 서비스 품질은 변경 X

**셀 위치 추적(cell location tracking)**

- 이동 장치가 셀 사이를 이동함에 따라, 기지국들은 이동장치의 위치에서 MME를 갱신
- but 이동 장치가 수면 모드인데 셀 사이를 이동하는 경우 → 기지국은 더 이상 해당 장치의 위치를 추적 X
  →  **`페이징 프로세스`**를 통해 깨어난 장치를 찾는 것은 MME의 책임

### **`2G에서 3G, 그리고 4G로의 네트워크 구조 변화`**

**2G 셀룰러 구조**

> 통신 사업자 코어 네트워크를 통한 회선 교환 음성 서비스를 지원

![image](../image/7.3.png)

**3G 시스템 구조**

> 통신 사업자 코어 네트워크를 통해 회선 교환 음성 서비스와 패킷 교환 데이터 서비스를 별도로 지원

![image](../image/7.4.png)

**4G 시스템 구조**

![image](../image/7.5.png)

### **7.4.2 LTE 프로토콜 스택**

- 4G LTE :  **`all-IP 네트워크 구조`**
  → LTE 프로토콜 스택의 상위 계층은 IP, TCP, UDP, 그리고 다양한 애플리케이션 계층 프로토콜들로 구성

LTE는 이동 장치의 `링크 계층`을 3개의 부계층으로 나눔

1. **패킷 데이터 융합(Packet Data Convergence)**
   - **`PDCP(Packet Data Convergence Protocol)`**는 무선 링크를 통해 전송되는 비트 수를 줄이기 위해 IP 헤더 압축을 수행
   - LTE 이동 장치가 네트워크에 처음 연결될 때,
     이동 장치와 이동성 관리 개체(MME) 사이의 시그널링 메시지 교환을 통해 설정된 키를 사용한 암호화/복호화 기능을 수행
2. **무선 링크 제어(Radio Link Control, RLC)**
   - 링크 계층 프레임에 적용하기에는 너무 큰 `IP 데이터그램`의 송신시 **단편화** 및 수신시 **재조립** 수행
   - ACK/NAK 기반 ARQ 프로토콜의 사용을 통한 링크 계층에서의 **신뢰성 있는 데이터 전송** 수행
3. **매체 접속 제어(Medium Access Control, MAC)**
   - **전송 스케줄링**수행 (무선 전송 슬롯의 요청 및 사용 제어)
   - 추가적인 오류 감지/ 정정 기능을 수행
   - 중복 비트 사용을 통한 순방향 오류 정정 기능

### **7.4.3 LTE 무선 접속 네트워크**

### **7.4.4 추가적인 LTE 기능: 네트워크 접속과 전원 관리**

**이동 장치가 셀룰러 사업자의 네트워크의 접속하는 절차**

**`기지국과의 접속`**

1. 이동 장치는 초기에 모든 주파수 대역의 모든 채널에서 기지국에 의해 5ms마다 주기적으로 보로드캐스트되는 기본 동기화 신호를 검색
2. 기본 동기화 신호가 발견 → 이동 장치는 해당 주파수를 유지하고 보조 동기화 신호를 탐색
   - 보조 동기화 신호에서 찾은 정보와 몇 가지 추가 단계를 거쳐서 이동 장치는 채널 대역폭, 채널 구성 및 해당 기지국의 셀룰러 사업자 정보화 같은 추가 정보 찾음
3. 위 과정에서 찾은 정보로 무장한 이동 장치는 연결한 기지국을 선택하고, 해당 기지국과의 무선 홉을 통해 제어 평면의 신호 연결 설정

**`상호 인증`**

1. 기지국이 MME에 접속하여 상호 인증을 수행
2. 상호 인증 → 네트워크는 접속하려는 장치가 실제로 주어진 **IMSI와 연관된 장치**이며, 이동 장치는 접속 시도 중인 네트워크가 **합법적인 셀룰러 사업자 네트워크**임 확인
3. 상호 인증 단계가 완료 → MME와 이동 장치가 서로 상호 인증되고, MME도 이동 장치가 연결된 기지국의 ID를 알게 됨

**`매체 이동 장치와 PDN 게이트웨이 간 경로 구성`**

1. MME는 PDN 게이트웨이, 서빙 게이트웨이, 기지국에 연결하여 2개의 터널 설정
2. 이동 장치는 기지국과 연결된 터널을 통해 인터넷과 IP 데이터그램을 송수신 가능

### **`전력 관리: 수면 모드`**

무선 장치는 전력 소모를 최소화하기 위해 (= 데이터 송수신 및 채널 감지를 위해 이동 장치의 회로가 켜져 있어야 하는 시간을 최소화하고자) 송수신하지 않을 때 → 수면 상태로 전환

**불연속 수신 상태**

- **약한 수면**
- 일반적으로 수백 밀리초의 비활성 기간 이후에 시작되는 단계
- 이동 장치와 기지국은 이동 장치가 깨어나기 위한 주기적인 시간을 미리 예약한 후, 주기적으로 기지국에서 이동 장치로의 다운스트림 전송을 위해 **채널을 능동적으로 모니터링**
  - **`but`** 예정된 스케줄링 시간과는 별개로 이동 장치의 무선 부분은 수면 상태일 수 O

**유휴 상태**

- **깊은 수면**
- 이동 장치가 수면 상태인 동안 통신 사업자 네트워크의 새로운 셀로 이동하는 경우, **이전에 결합되었던 기지국에 알릴 필요 X**
- 깊은 수면에서 깨어날 때 이동 장치는MME가 이동 장치가 과거에 마지막으로 결합했던 기지국 근처의 다른 기지국들로 브로드캐스트하는 페이징 메시지를 확인하기 위해 (잠재적으로 새로운) 기지국과의 결합을 재설정해야 함
  - 제어 평면 페이징 메시지는 기지국에 의해 해당 셀 내의 모든 이동 장치로 브로드캐스트 됨
  - 메시지 : **어떤 이동 장치가** 패킷을 수신하기 위해 완전히 깨어나야 하고, 기지국에 대한 새로운 데이터 평면 연결을 재성정해야 하는지 보여줌

### **7.4.5 글로벌 셀룰러 네트워크: 네트워크들의 네트워크**

### **7.4.6 5G 셀룰러 네트워크**

- 5G는 4G에 비해 대략 10배의 최대 비트 전송률, 10배 빠른 지연 시간, 그리고 100배 이상의 트래픽 용량을 제공할 것으로 예측
- **장점**
  - 훨씬 빠른 데이터 속도
- **단점**
  - 기지국에서 수신기까지의 도달 범위가 훨씬 짧음
    → 농촌 지역에 부적합하며, 도시 지역에는 더 밀집된 기지국 배치를 필요로 함
  - 대기 간섭에 매우 취약
- 5G의 물리 계층(즉, 무선) 측면은 LTE와 같은 4G 이동 통신 시스템과 역방향 호환 X
  - 기지국 업그레이드나 소프트웨어 업그레이드를 통해 기존 스마트폰을 지원할 수 X
    → 5G로의 전환을 위해 이동 통신 사업자는 물리적 인프라 새로 투자해야 함

### **5G 코어 네트워크**

5G 모바일 음성, 데이터 및 인터넷 연결을 모두 관리하는 데이터 네트워크

- 인터넷 및 클라우드 기반 서비스와 더 잘 통합되도록 재설계
- 네트워크 전체에 분산 서버와 캐시를 포함하여 지연 시간 줄임
- 모든 네트워크 요소(이동 장치, 셀, 기지국, MME, HSS, 서빙 게이트웨이, PDN 게이트웨이)를 포함

**`5G 코어 아키텍처`**

- 5G 코어는 **제어 평면과 사용자 평면의 완전한 분리**를 위해 설계
  → 온전히 가상화된 소프트웨어 기반 네트워크 기능으로 구성됨
  → 사업자가 다양한 5G 애플리케이션의 다양한 요구 사항을 충족할 수 있는 유연성 제공

**`5G 핵심 네트워크 기능`**

- **사용자 평면 기능(User-Plane Function, UPF)**
  - 제어와 사용자 평면 분리를 통해 패킷 처리를 네트워크 가장자리로 보내 분산시킴
- **접속 및 이동성 관리 기능(Access and Mobility Management Function, AMF)**
- **세션 관리 기능(Session Management Function, SMF)**
  - 제어와 분리된 데이터 평면과의 상호작용 담당
  - IP 주소 관리를 담당하고 DHCP 역할 수행
